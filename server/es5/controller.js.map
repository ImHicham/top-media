{"version":3,"sources":["controller.js"],"names":[],"mappings":";;AAAA,IAAI,aAAa,GAAG,OAAO,CAAC,uBAAuB,CAAC,CAAC;AACrD,IAAI,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;;AAKzB,MAAM,CAAC,OAAO,GAAG;AAChB,aAAY,EAAC,sBAAC,GAAG,EAAE,GAAG,EAAE;AACvB,MAAI,QAAQ,GAAG,IAAI,aAAa,EAAE,CAAC;AACjC,UAAQ,CAAC,MAAM,EAAE,CACZ,IAAI,CAAE,UAAA,MAAM;UAAI,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC;GAAA,CAAE,CACzC,IAAI,CAAE,UAAA,MAAM;UAAI,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC;GAAA,CAAE,CAC5C,IAAI,CAAE,UAAA,MAAM;UAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC;GAAA,CAAE,CACvC,IAAI,CAAE;UAAM,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC;GAAA,CAAE,CAAC;EACzC;;AAED,WAAU,EAAC,oBAAC,GAAG,EAAE,GAAG,EAAE;AACrB,SAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;;AAE3B,MAAI,OAAO,GAAG,GAAG,CAAC,KAAK,CAAC;AACxB,MAAI,cAAc,GAAG,EAAE,CAAC;;;AAGxB,MAAK,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAG;AAC/B,UAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,eAAe,EAAC,MAAM,CAAC,EAAE,CAAC,gBAAgB,EAAC,MAAM,CAAC,CAAC,CAAC;GACxE;;;AAGD,MAAK,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAG;AAClC,UAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,YAAY,EAAC,MAAM,CAAC,CAAC,CAAC;GACzC,CAAC;;AAEF,MAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,EAAE,EAAE;AAC/B,iBAAc,CAAC,UAAU,GAAG,EAAC,IAAI,EAAI,OAAO,CAAC,IAAI,EAAE,IAAI,EAAG,OAAO,CAAC,EAAE,EAAC,CAAC;GACtE,CAAC;;AAEF,IAAE,CAAC,OAAO,EAAE,CAAC,IAAI,CAAE,UAAA,EAAE,EAAI;AACvB,OAAI,UAAU,GAAG,EAAE,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;AACvC,aAAU,CAAC,IAAI,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC,OAAO,CAAC,UAAU,GAAG,EAAE,IAAI,EAAE;AACpE,QAAI,GAAG,EACL,OAAO,GAAG,CAAC;AACb,OAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAChB,CAAC,CAAC;GACJ,CAAC,CAAC;EACN;;CAED,CAAA","file":"controller.js","sourcesContent":["var YoutubeSource = require(\"./model/youtubeSource\");\r\nvar db = require(\"./db\");\r\n\r\n\r\n\r\n\r\nmodule.exports = {\r\n\tsearchTweets (req, res) {\r\n\t\tlet instance = new YoutubeSource();\r\n  \t\tinstance.search()\r\n  \t\t\t\t\t\t.then( tweets => instance.filter(tweets) )\r\n  \t\t\t\t\t\t.then( tweets => instance.transform(tweets) )\r\n  \t\t\t\t\t\t.then( tweets => instance.save(tweets) )\r\n  \t\t\t\t\t\t.then( () => res.sendStatus(200) );\r\n\t},\r\n\r\n\tfindFromDB (req, res) {\r\n\t\tconsole.log(\"getting videos\");\r\n\r\n\t    let options = req.query;\r\n\t    let searchCriteria = {};\r\n\r\n\t    //if contains 'best'\r\n\t    if ( /best/.test(options.sort) ) {\r\n\t      options.sort.push(['retweet_count','desc'], ['favorite_count','desc']);\r\n\t    }\r\n\r\n\t    //if contains 'newest'\r\n\t    if ( /newest/.test(options.sort) ) {\r\n\t    \toptions.sort.push(['scraped_at','desc']);\r\n\t    };\r\n\r\n\t    if (options.from && options.to) {\r\n\t    \tsearchCriteria.scraped_at = {$gte :  options.from, $lte : options.to};\r\n\t    };\r\n\r\n\t    db.connect().then( db => {\r\n\t      var collection = db.collection(\"post\");\r\n\t      collection.find(searchCriteria, options).toArray(function (err, data) {\r\n\t        if (err) \r\n\t          return err;\r\n\t        res.json(data);\r\n\t      });\r\n\t    });\r\n\t}\r\n\r\n}"],"sourceRoot":"C:\\Users\\stwo\\Desktop\\web\\top-media\\server\\es6"}